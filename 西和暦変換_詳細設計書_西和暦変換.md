## 西和暦変換		
プログラムID:SUB2002		
		
## 環境部		
### 入出力節		
ファイル管理段落		
・西暦ファイルを/home/suzuki/DATA/SEIREKI2002とのファイルの対応を宣言する。		

・順ファイルの入出力状態(西暦状態)を宣言する。		

・和暦ファイルを/home/suzuki/DATA/WAREKI2002とのファイルの対応を宣言する。		

・順ファイルの入出力状態(和暦状態)を宣言する。		
		
## データ部		
### ファイル節		
西暦ファイルをファイル節に記述する。		
集団項目(レベル番号01)→コピー句:CP004		

|項目名|設定値|
|---|---|
|西暦レコード|-|

基本項目(レベル番号05)		

|項目名|桁数|備考|
|---|---|---|
|西暦年月日|8(9タイプ)|-|	

基本項目(レベル番号10)		

|項目名|桁数|備考|
|---|---|---|
|西暦年|4(9タイプ)|-|
|西暦月|2(2タイプ)|-|
|西暦月|2(2タイプ)|-|
		
和暦ファイルをファイル節に記述する。		
集団項目(レベル番号01)→コピー句:CP005		

|項目名|設定値|
|---|---|
|和暦レコード|-|

基本項目(レベル番号05)		

|項目名|桁数|備考|
|---|---|---|
|和暦年月日|-|-|

基本項目(レベル番号10)		

|項目名|桁数|備考|
|---|---|---|
|和暦|1(Xタイプ)|-|
|和暦年|X(9タイプ)|-|
|和暦月|X(9タイプ)|-|
|和暦日|X(9タイプ)|-|
		
集団項目(レベル番号01)		

|項目名|設定値|
|---|---|
|ワークエリア|-|

集団項目(レベル番号05)		

|項目名|設定値|	
|---|---|
|状態|-|

基本項目(レベル番号10)		

|項目名|桁数|	
|---|---|
|西暦状態|2(Xタイプ)|	
|和暦状態|2(Xタイプ)|	
|終了ステータス|1(Xタイプ)|-|
|読み込み件数|2(9タイプ)|-|
|出力件数|2(9タイプ)|-|
|閏年コード|1(Xタイプ)|1:閏年2:閏年以外|
|西暦年／１００|4(9タイプ)|-|
|西暦年／４００|4(9タイプ)|-|
|西暦年／４|4(9タイプ)|1:閏年2:閏年以外|
|Ｒ１００|4(9タイプ)|-|
|Ｒ４００|4(9タイプ)|-|
|Ｒ４|4(9タイプ)|1:閏年2:閏年以外|
		
集団項目(レベル番号05)→コピー句		

|項目名|設定値|
|---|---|
|退避レコード|-|

基本項目(レベル番号05)		

|項目名|桁数|備考|
|---|---|---|
|和暦年月日|-|-|

基本項目(レベル番号10)		

|項目名|桁数|備考|
|---|---|---|
|和暦|1(Xタイプ)|-|
|和暦年|X(9タイプ)|-|
|和暦年Ａ|2(9タイプ)|和暦年を再定義|
|和暦月|X(9タイプ)|-|
|和暦日|X(9タイプ)|-|
		
手続き部		
### 0開始セクション		
		
### 1.初期処理セクションへ		
		
### 2.主処理セクションへ		
		
### 3.終了処理セクションへ		
		
### 4.プログラムを終了させる。		
		
## 1.初期処理セクション		
・西暦レコードを初期化する。		
		
・和暦レコードを初期化する。		
		
・ワークエリアを初期化する。		
		
・退避レコードを初期化する。		
		
西暦ファイルを入力モードで開く。		
和暦ファイルを出力モードで開く。		
ファイル存在チェックする。		
・西暦状態かつ和暦状態が 00以外の場合		
## 4.異常終了処理へ		
		
・西暦状態かつ和暦状態が 00の場合		
処理しない。		
		
		
## 2.主処理セクション		
		
終了ステータスが1になるまで西暦ファイルを読み込むのを繰り返す。		
・読み込み終了時		
終了ステータスを1に設定する。		
出力件数を表示。		
・読み込み時		
読み込み件数に1を追加。		
読み込み件数 "レコード目:" 西暦年月日を表示する。		
### 2.1.月判定処理セクションへ		
### 2.2.日判定処理セクションへ		
### 2.3西暦和暦処理へ		
### 2.4.和暦出力処理へ		
出力件数に1を追加。		
退避レコードを初期化する。		
		
## 2.1月判定処理セクション		
13月などのあり得ない月を排除する		
・西暦月が数字の時、		
かつ西暦月が1以上で12以下の時		
西暦月を退避レコードの和暦月に設定する。		
・西暦月が数字の時かつ西暦月が0以下または13以上の時		
### 4.異常終了処理へ		
・西暦月が数字以外の時		
### 4.異常終了処理へ		
		
## 2.2.月判定処理セクション		
		
1月から12月まであり得ない日を排除する		
・西暦日が数字の時かつ		
・1月		
・数字かつ1日から31日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
・数字かつそれ以外(0日や32日の時)		
### 4.異常終了処理へ		
		
・2月		
### 2.2.1閏年判定処理へ		
・数字かつ閏年判定区分が1かつ1日から29日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
数字かつ閏年判定区分が1かつそれ以外なら(0日や30日など)		
### 4.異常終了処理へ		
		
・数字かつ閏年判定区分が2かつ1日から28日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
数字かつ閏年判定区分が2かつそれ以外なら(0日や29日など)		
### 4.異常終了処理へ		
		
・3月		
・数字かつ1日から31日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
・数字かつそれ以外(0日や32日の時)		
### 4.異常終了処理へ		
		
・4月		
・数字かつ1日から30日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
・数字かつそれ以外(0日や31日の時)		
### 4.異常終了処理へ		
		
・5月		
・数字かつ1日から31日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
・数字かつそれ以外(0日や32日の時)		
### 4.異常終了処理へ		
		
・6月		
・数字かつ1日から30日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
・数字かつそれ以外(0日や31日の時)		
### 4.異常終了処理へ		
		
・7月		
・数字かつ1日から31日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
・数字かつそれ以外(0日や32日の時)		
### 4.異常終了処理へ		
		
・8月		
・数字かつ1日から31日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
・数字かつそれ以外(0日や32日の時)		
### 4.異常終了処理へ		
		
・9月		
・数字かつ1日から30日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
・数字かつそれ以外(0日や31日の時)		
### 4.異常終了処理へ		
		
10月		
・数字かつ1日から31日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
・数字かつそれ以外(0日や32日の時)		
### 4.異常終了処理へ		
		
・11月		
・数字かつ1日から30日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
・数字かつそれ以外(0日や31日の時)		
### 4.異常終了処理へ		
		
12月		
・数字かつ1日から31日までの日なら		
西暦日を退避レコードの和暦日に設定する。		
・数字かつそれ以外(0日や32日の時)		
### 4.異常終了処理へ		
		
・西暦日が数字以外の時		
### 4.異常終了処理へ		
		
## 2.2.1閏年判定処理		
西暦年を100で割って出た余りがR100		
西暦年を400で割って出た余りがR400		
西暦年を4で割って出た余りがR4		
		
R400=0またはR4=0かつR100≠０の時		
閏年コードに1を設定する。		
		
それ以外の時		
閏年コードに2を設定する。		
		
## 2.3.西暦和暦処理		
・西暦年が数字の時かつ		
・西暦年月日が18681023以上かつ19120729以下なら		
退避レコードの和暦にMをせっていする。		
退避レコードの和暦年A=西暦年ｰ1867		
		
・西暦年月日が19120730以上かつ19261224以下なら		
退避レコードの和暦にTをせっていする。		
退避レコードの和暦年A=西暦年ｰ1911		
		
・西暦年月日が19261225以上かつ19890107以下なら		
退避レコードの和暦にSをせっていする。		
退避レコードの和暦年A=西暦年ｰ1925		
		
・西暦年月日が19890108以上かつ20190430以下なら		
		
退避レコードの和暦年A=西暦年ｰ1988		
		
・西暦年月日が20190501以上なら		
退避レコードの和暦にRをせっていする。		
退避レコードの和暦年A=西暦年ｰ2018		
		
・西暦年が数字以外の時		
### 4.異常終了処理へ		
		
## 2.4.和暦出力処理		
退避レコードから和暦レコードを書き込む。		
		
## 3.終了処理セクション		
## 3-1.終了処理		
和暦ファイルを閉じる。		
西暦ファイルを閉じる。		
		
SUB2003を呼ぶする。		
		
## 4.異常終了処理		
異常終了を表示させる		
西暦年月日を表示させる		
		
和暦ファイルを閉じる。		
西暦ファイルを閉じる。		
		
この時点で書き込まれた和暦ファイルを読み込む。		
SUB2003を呼ぶする。		
		
プログラムを終了させる。		
